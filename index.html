<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è„±ãƒ»Sorryï¼AIãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤ãƒ³ã‚°</title>
    <style>
        body { font-family: sans-serif; background: #f4f4f9; display: flex; justify-content: center; padding: 20px; }
        #chat-container { width: 100%; max-width: 500px; background: white; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); overflow: hidden; }
        #chat-box { height: 400px; overflow-y: auto; padding: 20px; border-bottom: 1px solid #ddd; display: flex; flex-direction: column; }
        .message { margin-bottom: 15px; line-height: 1.5; padding: 10px; border-radius: 8px; max-width: 80%; }
        .alex { background: #ffebee; color: #d32f2f; align-self: flex-start; border: 1px solid #ffcdd2; }
        .user { background: #e3f2fd; color: #1976d2; align-self: flex-end; border: 1px solid #bbdefb; }
        .input-area { display: flex; padding: 10px; }
        input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px; outline: none; }
        button { padding: 10px 20px; background: #333; color: white; border: none; border-radius: 5px; margin-left: 5px; cursor: pointer; }
        button:disabled { background: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>

<div id="chat-container">
    <div style="background: #333; color: white; padding: 15px; text-align: center; font-weight: bold;">
        VS Alex (å³ã—ã„ä¸Šå¸)
    </div>
    <div id="chat-box">
        <div class="message alex">Alex: Hey, I've been waiting for that updated report for over an hour. What's the hold-up?</div>
    </div>
    <div class="input-area">
        <input type="text" id="user-input" placeholder="Sorryã‚’ä½¿ã‚ãšã«è¿”ä¿¡..." onkeypress="if(event.key==='Enter') sendMessage()">
        <button id="send-btn" onclick="sendMessage()">é€ä¿¡</button>
    </div>
</div>

<script>
    // å›ã®ã‚­ãƒ¼ã‚’ç›´æ¥åŸ‹ã‚è¾¼ã‚“ã ã‚ˆã€‚
    const API_KEY = 'AIzaSyCvPaPcBQRsUi-kWyVTMcRwkkmQ6xPOzZI';

    async function sendMessage() {
        const inputField = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const userText = inputField.value;

        if (!userText) return;

        // äºŒé‡é€ä¿¡é˜²æ­¢
        sendBtn.disabled = true;
        appendMessage('You', userText, 'user');
        inputField.value = '';

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{
                        parts: [{ text: `ã‚ãªãŸã¯å³ã—ã„ä¸Šå¸Alexã§ã™ã€‚
                        ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä»Šã®ç™ºè¨€: "${userText}"
                        çŠ¶æ³: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ä»•äº‹ãŒé…ã‚Œã¦ã„ã‚‹ã¨ã‚ãªãŸã«æ€’ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚
                        ç›®æ¨™ãƒ•ãƒ¬ãƒ¼ã‚º: My bad. / Thanks for waiting. / Noted. / No biggie. / Let me check.
                        
                        ãƒ«ãƒ¼ãƒ«: 
                        1. è‹±èªã§1ã€œ2æ–‡ã€å°‘ã—å¨åœ§çš„ã«è¿”ä¿¡ã—ã¦ãã ã•ã„ã€‚
                        2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ "Sorry" ã‚’ä½¿ã£ãŸã‚‰ã€ã€Œè¬ã‚‰ãªãã¦ã„ã„ã€‚å…·ä½“çš„ã«ã©ã†ã™ã‚‹ã®ã‹æ•™ãˆã‚ã€ã¨å³ã—ãæŒ‡æ‘˜ã—ã¦ãã ã•ã„ã€‚
                        3. è¿”ä¿¡ã®æœ€å¾Œã«ã€æ—¥æœ¬èªã§1è¡Œã ã‘ã€ŒğŸ’¡ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€ã‚’æ·»ãˆã¦ãã ã•ã„ã€‚` }]
                    }]
                })
            });

            const data = await response.json();
            
            if (data.candidates && data.candidates[0].content) {
                const alexReply = data.candidates[0].content.parts[0].text;
                appendMessage('Alex', alexReply, 'alex');
            } else {
                console.error(data);
                appendMessage('Alex', 'ã‚¨ãƒ©ãƒ¼ï¼šAIãŒã†ã¾ãè¿”äº‹ã§ããªã‹ã£ãŸã¿ãŸã„ã€‚', 'alex');
            }
        } catch (error) {
            console.error(error);
            appendMessage('Error', 'æ¥ç¶šã«å¤±æ•—ã€‚ãƒãƒƒãƒˆã‹ã‚­ãƒ¼ã®å•é¡Œã‹ã‚‚ã€‚', 'alex');
        } finally {
            sendBtn.disabled = false;
        }
    }

    function appendMessage(sender, text, className) {
        const div = document.createElement('div');
        div.className = `message ${className}`;
        div.innerHTML = `<strong>${sender}:</strong><br>${text}`;
        chatBox.appendChild(div);
        chatBox.scrollTop = chatBox.scrollHeight;
    }
</script>

</body>
</html>
